<% _callback_layout = "./includes/callback_layout.md.erb" %>
<% _function_layout = "./includes/function_layout.md.erb" %>
<% _pre_callback = "includes/entity/callbacks/" %>
<% _pre_func = "includes/entity/functions/" %>
<% _pre = "includes/entity/functions/" %>
<% _suf = ".erb" %>
<% _suf2 = ".md.erb" %>

<%# The ones marked with "conditional" are ones that are only included by certain entity types. %>
<% _functions = 
    [
        { name: "get_name" },
        { name: "set_name", conditional: true },
        { name: "get_rank", conditional: true },
        { name: "set_rank", conditional: true },
        { name: "get_element" },
        { name: "set_element" },
        { name: "get_attack_level", conditional: true },
        { name: "set_attack_level", conditional: true },
        { name: "get_charge_level", conditional: true },
        { name: "set_charge_level", conditional: true },
        { name: "set_fully_charged_color", conditional: true },
        { name: "set_charge_position", conditional: true },

        { name: "get_id" },
        { name: "get_health" },
        { name: "set_health", incomplete: true },
        { name: "get_max_health" },
        { name: "mod_max_health", conditional: true },
        { name: "get_max_health_mod", conditional: true },
        { name: "get_facing" },
        { name: "get_facing_away" },
        { name: "set_facing" },
        { name: "get_team" },
        { name: "is_team" },
        { name: "set_float_shoe", conditional: true },
        { name: "set_air_shoe", conditional: true },
        { name: "slide_when_moving", conditional: true },
        { name: "set_height" },
        { name: "get_height" },
        { name: "get_elevation" },
        { name: "set_elevation" },
        { name: "get_offset" },
        { name: "set_offset" },
        { name: "get_tile_offset" },

        { name: "get_color", incomplete: true },
        { name: "set_color", incomplete: true },
        { name: "sprite", incomplete: true },
        { name: "is_passthrough", incomplete: true },
        { name: "is_deleted", incomplete: true },
        { name: "erase", incomplete: true },
        { name: "will_erase_eof", incomplete: true },
        { name: "get_texture", incomplete: true },
        { name: "set_texture", incomplete: true },
        { name: "set_animation", incomplete: true },
        { name: "get_animation", incomplete: true },
        { name: "create_node", incomplete: true },
        { name: "get_context", incomplete: true },
        { name: "get_current_palette", incomplete: true },
        { name: "set_palette", incomplete: true },
        { name: "get_base_palette", incomplete: true },
        { name: "store_base_palette", incomplete: true },

        { name: "get_field" },
        { name: "get_tile" },
        { name: "get_current_tile" },
        { name: "share_tile", conditional: true },

        { name: "slide" },
        { name: "jump" },
        { name: "teleport" },
        { name: "raw_move_action" },

        { name: "is_sliding" },
        { name: "is_jumping" },
        { name: "is_teleporting" },
        { name: "is_moving" },

        { name: "hide" },
        { name: "reveal" },
        { name: "show_shadow" },
        { name: "set_shadow", conditional: true },
        
        { name: "copy_hit_props" },
        { name: "set_hit_props" },

        { name: "toggle_hitbox", conditional: true },
        { name: "toggle_counter", conditional: true },
        { name: "add_defense_rule", conditional: true },
        { name: "remove_defense_rule", conditional: true },

        { name: "never_flip" },
        { name: "highlight_tile" },
        { name: "register_component" },
        { name: "shake_camera", conditional: true },
        { name: "set_explosion_behavior", conditional: true },

        { name: "register_status_callback", conditional: true }
    ]
%>

<% _callbacks =
    [
        { name: "battle_start_func", conditional: true },
        { name: "on_spawn_func", conditional: true },
        { name: "battle_end_func", conditional: true },
        { name: "can_move_to_func", conditional: true },
        { name: "attack_func", conditional: true },
        { name: "collision_func", conditional: true },
        { name: "update_func", conditional: true },
        { name: "delete_func", conditional: true },
        { name: "normal_attack_func", conditional: true },
        { name: "charged_attack_func", conditional: true },
        { name: "special_attack_func", conditional: true },
    ]
%>

<% partial "" + locals[:data] if locals[:data].present? %>

<% _functions.each do |func| %>
    <% if func[:conditional].nil? %>
        <%= partial _function_layout, locals: { datafile: _pre_func + func[:name] + _suf } %>
    <% elsif locals[:extras].include? func[:name] %>
        <%= partial _function_layout, locals: { datafile: _pre_func + func[:name] + _suf } %>
    <% end %>
<% end %>

<% _callbacks.each do |callback| %>
    <% if callback[:conditional].nil? %>
        <%= partial _callback_layout, locals: { datafile: _pre_callback + callback[:name] + _suf } %>
    <% elsif locals[:extras].include? callback[:name] %>
        <%= partial _callback_layout, locals: { datafile: _pre_callback + callback[:name] + _suf } %>
    <% end %>
<% end %>

<%# The lines with the 'if' statements are ones that are only included by certain entity types. %>